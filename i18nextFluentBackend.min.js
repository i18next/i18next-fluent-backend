!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.i18nextFluentBackend=t()}(this,function(){"use strict";let e=[],t=e.forEach,n=e.slice;function r(e,t){if(t&&"object"==typeof t){let n="",r=encodeURIComponent;for(let e in t)n+="&"+r(e)+"="+r(t[e]);if(!n)return e;e=e+(-1!==e.indexOf("?")?"&":"?")+n.slice(1)}return e}function s(e,t,n,s,i){s&&"object"==typeof s&&(i||(s._t=new Date),s=r("",s).slice(1)),t.queryStringParams&&(e=r(e,t.queryStringParams));try{var a;(a=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0")).open(s?"POST":"GET",e,1),t.crossDomain||a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.withCredentials=!!t.withCredentials,s&&a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.overrideMimeType&&a.overrideMimeType("application/json");var o=t.customHeaders;if(o)for(var c in o)a.setRequestHeader(c,o[c]);a.onreadystatechange=function(){a.readyState>3&&n&&n(a.responseText,a)},a.send(s)}catch(e){console&&console.log(e)}}class i{constructor(){this.type="BaseNode"}equals(e,t=["span"]){const n=new Set(Object.keys(this)),r=new Set(Object.keys(e));if(t)for(const e of t)n.delete(e),r.delete(e);if(n.size!==r.size)return!1;for(const s of n){if(!r.has(s))return!1;const n=this[s],i=e[s];if(typeof n!=typeof i)return!1;if(n instanceof Array&&i instanceof Array){if(n.length!==i.length)return!1;for(let e=0;e<n.length;++e)if(!a(n[e],i[e],t))return!1}else if(!a(n,i,t))return!1}return!0}clone(){function e(t){return t instanceof i?t.clone():Array.isArray(t)?t.map(e):t}const t=Object.create(this.constructor.prototype);for(const n of Object.keys(this))t[n]=e(this[n]);return t}}function a(e,t,n){return e instanceof i&&t instanceof i?e.equals(t,n):e===t}class o extends i{constructor(){super(...arguments),this.type="SyntaxNode"}addSpan(e,t){this.span=new N(e,t)}}class c extends o{constructor(e=[]){super(),this.type="Resource",this.body=e}}class u extends o{constructor(){super(...arguments),this.type="Entry"}}class h extends u{constructor(e,t=null,n=[],r=null){super(),this.type="Message",this.id=e,this.value=t,this.attributes=n,this.comment=r}}class l extends u{constructor(e,t,n=[],r=null){super(),this.type="Term",this.id=e,this.value=t,this.attributes=n,this.comment=r}}class p extends o{constructor(e){super(),this.type="Pattern",this.elements=e}}class f extends o{constructor(){super(...arguments),this.type="PatternElement"}}class d extends f{constructor(e){super(),this.type="TextElement",this.value=e}}class g extends f{constructor(e){super(),this.type="Placeable",this.expression=e}}class k extends o{constructor(){super(...arguments),this.type="Expression"}}class m extends k{constructor(e){super(),this.type="Literal",this.value=e}}class x extends m{constructor(){super(...arguments),this.type="StringLiteral"}parse(){return{value:this.value.replace(/(?:\\\\|\\"|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g,function(e,t,n){switch(e){case"\\\\":return"\\";case'\\"':return'"';default:{let e=parseInt(t||n,16);return e<=55295||57344<=e?String.fromCodePoint(e):"�"}}})}}}class w extends m{constructor(){super(...arguments),this.type="NumberLiteral"}parse(){let e=parseFloat(this.value),t=this.value.indexOf(".");return{value:e,precision:t>0?this.value.length-t-1:0}}}class E extends k{constructor(e,t=null){super(),this.type="MessageReference",this.id=e,this.attribute=t}}class C extends k{constructor(e,t=null,n=null){super(),this.type="TermReference",this.id=e,this.attribute=t,this.arguments=n}}class y extends k{constructor(e){super(),this.type="VariableReference",this.id=e}}class v extends k{constructor(e,t){super(),this.type="FunctionReference",this.id=e,this.arguments=t}}class b extends k{constructor(e,t){super(),this.type="SelectExpression",this.selector=e,this.variants=t}}class P extends o{constructor(e=[],t=[]){super(),this.type="CallArguments",this.positional=e,this.named=t}}class S extends o{constructor(e,t){super(),this.type="Attribute",this.id=e,this.value=t}}class B extends o{constructor(e,t,n){super(),this.type="Variant",this.key=e,this.value=t,this.default=n}}class I extends o{constructor(e,t){super(),this.type="NamedArgument",this.name=e,this.value=t}}class A extends o{constructor(e){super(),this.type="Identifier",this.name=e}}class T extends u{constructor(e){super(),this.type="BaseComment",this.content=e}}class O extends T{constructor(){super(...arguments),this.type="Comment"}}class V extends T{constructor(){super(...arguments),this.type="GroupComment"}}class $ extends T{constructor(){super(...arguments),this.type="ResourceComment"}}class L extends o{constructor(e){super(),this.type="Junk",this.annotations=[],this.content=e}addAnnotation(e){this.annotations.push(e)}}class N extends i{constructor(e,t){super(),this.type="Span",this.start=e,this.end=t}}class j extends o{constructor(e,t=[],n){super(),this.type="Annotation",this.code=e,this.arguments=t,this.message=n}}class q extends Error{constructor(e,...t){super(),this.code=e,this.args=t,this.message=function(e,t){switch(e){case"E0001":return"Generic error";case"E0002":return"Expected an entry start";case"E0003":{const[e]=t;return`Expected token: "${e}"`}case"E0004":{const[e]=t;return`Expected a character from range: "${e}"`}case"E0005":{const[e]=t;return`Expected message "${e}" to have a value or attributes`}case"E0006":{const[e]=t;return`Expected term "-${e}" to have a value`}case"E0007":return"Keyword cannot end with a whitespace";case"E0008":return"The callee has to be an upper-case identifier or a term";case"E0009":return"The argument name has to be a simple identifier";case"E0010":return"Expected one of the variants to be marked as default (*)";case"E0011":return'Expected at least one variant after "->"';case"E0012":return"Expected value";case"E0013":return"Expected variant key";case"E0014":return"Expected literal";case"E0015":return"Only one variant can be marked as default (*)";case"E0016":return"Message references cannot be used as selectors";case"E0017":return"Terms cannot be used as selectors";case"E0018":return"Attributes of messages cannot be used as selectors";case"E0019":return"Attributes of terms cannot be used as placeables";case"E0020":return"Unterminated string expression";case"E0021":return"Positional arguments must not follow named arguments";case"E0022":return"Named arguments must be unique";case"E0024":return"Cannot access variants of a message.";case"E0025":{const[e]=t;return`Unknown escape sequence: \\${e}.`}case"E0026":{const[e]=t;return`Invalid Unicode escape sequence: ${e}.`}case"E0027":return"Unbalanced closing brace in TextElement.";case"E0028":return"Expected an inline expression";case"E0029":return"Expected simple expression as selector";default:return e}}(e,t)}}class R{constructor(e){this.string=e,this.index=0,this.peekOffset=0}charAt(e){return"\r"===this.string[e]&&"\n"===this.string[e+1]?"\n":this.string[e]}currentChar(){return this.charAt(this.index)}currentPeek(){return this.charAt(this.index+this.peekOffset)}next(){return this.peekOffset=0,"\r"===this.string[this.index]&&"\n"===this.string[this.index+1]&&this.index++,this.index++,this.string[this.index]}peek(){return"\r"===this.string[this.index+this.peekOffset]&&"\n"===this.string[this.index+this.peekOffset+1]&&this.peekOffset++,this.peekOffset++,this.string[this.index+this.peekOffset]}resetPeek(e=0){this.peekOffset=e}skipToPeek(){this.index+=this.peekOffset,this.peekOffset=0}}const M="\n",D=void 0,U=["}",".","[","*"];class H extends R{peekBlankInline(){const e=this.index+this.peekOffset;for(;" "===this.currentPeek();)this.peek();return this.string.slice(e,this.index+this.peekOffset)}skipBlankInline(){const e=this.peekBlankInline();return this.skipToPeek(),e}peekBlankBlock(){let e="";for(;;){const t=this.peekOffset;if(this.peekBlankInline(),this.currentPeek()!==M)return this.currentPeek()===D?e:(this.resetPeek(t),e);e+=M,this.peek()}}skipBlankBlock(){const e=this.peekBlankBlock();return this.skipToPeek(),e}peekBlank(){for(;" "===this.currentPeek()||this.currentPeek()===M;)this.peek()}skipBlank(){this.peekBlank(),this.skipToPeek()}expectChar(e){if(this.currentChar()!==e)throw new q("E0003",e);this.next()}expectLineEnd(){if(this.currentChar()!==D){if(this.currentChar()!==M)throw new q("E0003","␤");this.next()}}takeChar(e){const t=this.currentChar();return t===D?D:e(t)?(this.next(),t):null}isCharIdStart(e){if(e===D)return!1;const t=e.charCodeAt(0);return t>=97&&t<=122||t>=65&&t<=90}isIdentifierStart(){return this.isCharIdStart(this.currentPeek())}isNumberStart(){const e="-"===this.currentChar()?this.peek():this.currentChar();if(e===D)return this.resetPeek(),!1;const t=e.charCodeAt(0),n=t>=48&&t<=57;return this.resetPeek(),n}isCharPatternContinuation(e){return e!==D&&!U.includes(e)}isValueStart(){const e=this.currentPeek();return e!==M&&e!==D}isValueContinuation(){const e=this.peekOffset;return this.peekBlankInline(),"{"===this.currentPeek()?(this.resetPeek(e),!0):this.peekOffset-e!=0&&(!!this.isCharPatternContinuation(this.currentPeek())&&(this.resetPeek(e),!0))}isNextLineComment(e=-1){if(this.currentChar()!==M)return!1;let t=0;for(;t<=e||-1===e&&t<3;){if("#"!==this.peek()){if(t<=e&&-1!==e)return this.resetPeek(),!1;break}t++}const n=this.peek();return" "===n||n===M?(this.resetPeek(),!0):(this.resetPeek(),!1)}isVariantStart(){const e=this.peekOffset;return"*"===this.currentPeek()&&this.peek(),"["===this.currentPeek()?(this.resetPeek(e),!0):(this.resetPeek(e),!1)}isAttributeStart(){return"."===this.currentPeek()}skipToNextEntryStart(e){let t=this.string.lastIndexOf(M,this.index);for(e<t&&(this.index=t);this.currentChar();){if(this.currentChar()!==M){this.next();continue}const e=this.next();if(this.isCharIdStart(e)||"-"===e||"#"===e)break}}takeIDStart(){if(this.isCharIdStart(this.currentChar())){const e=this.currentChar();return this.next(),e}throw new q("E0004","a-zA-Z")}takeIDChar(){return this.takeChar(e=>{const t=e.charCodeAt(0);return t>=97&&t<=122||t>=65&&t<=90||t>=48&&t<=57||95===t||45===t})}takeDigit(){return this.takeChar(e=>{const t=e.charCodeAt(0);return t>=48&&t<=57})}takeHexDigit(){return this.takeChar(e=>{const t=e.charCodeAt(0);return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102})}}const G=/[ \t\n\r]+$/;function z(e){return function(t,...n){if(!this.withSpans)return e.call(this,t,...n);const r=t.index,s=e.call(this,t,...n);if(s.span)return s;const i=t.index;return s.addSpan(r,i),s}}class X{constructor({withSpans:e=!0}={}){this.withSpans=e,this.getComment=z(this.getComment),this.getMessage=z(this.getMessage),this.getTerm=z(this.getTerm),this.getAttribute=z(this.getAttribute),this.getIdentifier=z(this.getIdentifier),this.getVariant=z(this.getVariant),this.getNumber=z(this.getNumber),this.getPattern=z(this.getPattern),this.getTextElement=z(this.getTextElement),this.getPlaceable=z(this.getPlaceable),this.getExpression=z(this.getExpression),this.getInlineExpression=z(this.getInlineExpression),this.getCallArgument=z(this.getCallArgument),this.getCallArguments=z(this.getCallArguments),this.getString=z(this.getString),this.getLiteral=z(this.getLiteral),this.getComment=z(this.getComment)}parse(e){const t=new H(e);t.skipBlankBlock();const n=[];let r=null;for(;t.currentChar();){const e=this.getEntryOrJunk(t),s=t.skipBlankBlock();e instanceof O&&0===s.length&&t.currentChar()?r=e:(r&&(e instanceof h||e instanceof l?(e.comment=r,this.withSpans&&(e.span.start=e.comment.span.start)):n.push(r),r=null),n.push(e))}const s=new c(n);return this.withSpans&&s.addSpan(0,t.index),s}parseEntry(e){const t=new H(e);for(t.skipBlankBlock();"#"===t.currentChar();){const e=this.getEntryOrJunk(t);if(e instanceof L)return e;t.skipBlankBlock()}return this.getEntryOrJunk(t)}getEntryOrJunk(e){const t=e.index;try{const n=this.getEntry(e);return e.expectLineEnd(),n}catch(n){if(!(n instanceof q))throw n;let r=e.index;e.skipToNextEntryStart(t);const s=e.index;s<r&&(r=s);const i=e.string.substring(t,s),a=new L(i);this.withSpans&&a.addSpan(t,s);const o=new j(n.code,n.args,n.message);return o.addSpan(r,r),a.addAnnotation(o),a}}getEntry(e){if("#"===e.currentChar())return this.getComment(e);if("-"===e.currentChar())return this.getTerm(e);if(e.isIdentifierStart())return this.getMessage(e);throw new q("E0002")}getComment(e){let t,n=-1,r="";for(;;){let t=-1;for(;"#"===e.currentChar()&&t<(-1===n?2:n);)e.next(),t++;if(-1===n&&(n=t),e.currentChar()!==M){let t;for(e.expectChar(" ");t=e.takeChar(e=>e!==M);)r+=t}if(!e.isNextLineComment(n))break;r+=e.currentChar(),e.next()}switch(n){case 0:t=O;break;case 1:t=V;break;default:t=$}return new t(r)}getMessage(e){const t=this.getIdentifier(e);e.skipBlankInline(),e.expectChar("=");const n=this.maybeGetPattern(e),r=this.getAttributes(e);if(null===n&&0===r.length)throw new q("E0005",t.name);return new h(t,n,r)}getTerm(e){e.expectChar("-");const t=this.getIdentifier(e);e.skipBlankInline(),e.expectChar("=");const n=this.maybeGetPattern(e);if(null===n)throw new q("E0006",t.name);const r=this.getAttributes(e);return new l(t,n,r)}getAttribute(e){e.expectChar(".");const t=this.getIdentifier(e);e.skipBlankInline(),e.expectChar("=");const n=this.maybeGetPattern(e);if(null===n)throw new q("E0012");return new S(t,n)}getAttributes(e){const t=[];for(e.peekBlank();e.isAttributeStart();){e.skipToPeek();const n=this.getAttribute(e);t.push(n),e.peekBlank()}return t}getIdentifier(e){let t,n=e.takeIDStart();for(;t=e.takeIDChar();)n+=t;return new A(n)}getVariantKey(e){const t=e.currentChar();if(t===D)throw new q("E0013");const n=t.charCodeAt(0);return n>=48&&n<=57||45===n?this.getNumber(e):this.getIdentifier(e)}getVariant(e,t=!1){let n=!1;if("*"===e.currentChar()){if(t)throw new q("E0015");e.next(),n=!0}e.expectChar("["),e.skipBlank();const r=this.getVariantKey(e);e.skipBlank(),e.expectChar("]");const s=this.maybeGetPattern(e);if(null===s)throw new q("E0012");return new B(r,s,n)}getVariants(e){const t=[];let n=!1;for(e.skipBlank();e.isVariantStart();){const r=this.getVariant(e,n);r.default&&(n=!0),t.push(r),e.expectLineEnd(),e.skipBlank()}if(0===t.length)throw new q("E0011");if(!n)throw new q("E0010");return t}getDigits(e){let t,n="";for(;t=e.takeDigit();)n+=t;if(0===n.length)throw new q("E0004","0-9");return n}getNumber(e){let t="";return"-"===e.currentChar()?(e.next(),t+=`-${this.getDigits(e)}`):t+=this.getDigits(e),"."===e.currentChar()&&(e.next(),t+=`.${this.getDigits(e)}`),new w(t)}maybeGetPattern(e){return e.peekBlankInline(),e.isValueStart()?(e.skipToPeek(),this.getPattern(e,!1)):(e.peekBlankBlock(),e.isValueContinuation()?(e.skipToPeek(),this.getPattern(e,!0)):null)}getPattern(e,t){const n=[];let r,s;if(t){const t=e.index,s=e.skipBlankInline();n.push(this.getIndent(e,s,t)),r=s.length}else r=1/0;e:for(;s=e.currentChar();)switch(s){case M:{const t=e.index,s=e.peekBlankBlock();if(e.isValueContinuation()){e.skipToPeek();const i=e.skipBlankInline();r=Math.min(r,i.length),n.push(this.getIndent(e,s+i,t));continue e}e.resetPeek();break e}case"{":n.push(this.getPlaceable(e));continue e;case"}":throw new q("E0027");default:n.push(this.getTextElement(e))}const i=this.dedent(n,r);return new p(i)}getIndent(e,t,n){return new F(t,n,e.index)}dedent(e,t){const n=[];for(let r of e){if(r instanceof g){n.push(r);continue}if(r instanceof F&&(r.value=r.value.slice(0,r.value.length-t),0===r.value.length))continue;let e=n[n.length-1];if(e&&e instanceof d){const t=new d(e.value+r.value);this.withSpans&&t.addSpan(e.span.start,r.span.end),n[n.length-1]=t}else{if(r instanceof F){const e=new d(r.value);this.withSpans&&e.addSpan(r.span.start,r.span.end),r=e}n.push(r)}}const r=n[n.length-1];return r instanceof d&&(r.value=r.value.replace(G,""),0===r.value.length&&n.pop()),n}getTextElement(e){let t,n="";for(;t=e.currentChar();){if("{"===t||"}"===t)return new d(n);if(t===M)return new d(n);n+=t,e.next()}return new d(n)}getEscapeSequence(e){const t=e.currentChar();switch(t){case"\\":case'"':return e.next(),`\\${t}`;case"u":return this.getUnicodeEscapeSequence(e,t,4);case"U":return this.getUnicodeEscapeSequence(e,t,6);default:throw new q("E0025",t)}}getUnicodeEscapeSequence(e,t,n){e.expectChar(t);let r="";for(let s=0;s<n;s++){const n=e.takeHexDigit();if(!n)throw new q("E0026",`\\${t}${r}${e.currentChar()}`);r+=n}return`\\${t}${r}`}getPlaceable(e){e.expectChar("{"),e.skipBlank();const t=this.getExpression(e);return e.expectChar("}"),new g(t)}getExpression(e){const t=this.getInlineExpression(e);if(e.skipBlank(),"-"===e.currentChar()){if(">"!==e.peek())return e.resetPeek(),t;if(t instanceof E)throw null===t.attribute?new q("E0016"):new q("E0018");if(t instanceof C){if(null===t.attribute)throw new q("E0017")}else if(t instanceof g)throw new q("E0029");e.next(),e.next(),e.skipBlankInline(),e.expectLineEnd();const n=this.getVariants(e);return new b(t,n)}if(t instanceof C&&null!==t.attribute)throw new q("E0019");return t}getInlineExpression(e){if("{"===e.currentChar())return this.getPlaceable(e);if(e.isNumberStart())return this.getNumber(e);if('"'===e.currentChar())return this.getString(e);if("$"===e.currentChar()){e.next();const t=this.getIdentifier(e);return new y(t)}if("-"===e.currentChar()){e.next();const t=this.getIdentifier(e);let n,r;return"."===e.currentChar()&&(e.next(),n=this.getIdentifier(e)),e.peekBlank(),"("===e.currentPeek()&&(e.skipToPeek(),r=this.getCallArguments(e)),new C(t,n,r)}if(e.isIdentifierStart()){const t=this.getIdentifier(e);if(e.peekBlank(),"("===e.currentPeek()){if(!/^[A-Z][A-Z0-9_-]*$/.test(t.name))throw new q("E0008");e.skipToPeek();let n=this.getCallArguments(e);return new v(t,n)}let n;return"."===e.currentChar()&&(e.next(),n=this.getIdentifier(e)),new E(t,n)}throw new q("E0028")}getCallArgument(e){const t=this.getInlineExpression(e);if(e.skipBlank(),":"!==e.currentChar())return t;if(t instanceof E&&null===t.attribute){e.next(),e.skipBlank();const n=this.getLiteral(e);return new I(t.id,n)}throw new q("E0009")}getCallArguments(e){const t=[],n=[],r=new Set;for(e.expectChar("("),e.skipBlank();")"!==e.currentChar();){const s=this.getCallArgument(e);if(s instanceof I){if(r.has(s.name.name))throw new q("E0022");n.push(s),r.add(s.name.name)}else{if(r.size>0)throw new q("E0021");t.push(s)}if(e.skipBlank(),","!==e.currentChar())break;e.next(),e.skipBlank()}return e.expectChar(")"),new P(t,n)}getString(e){e.expectChar('"');let t,n="";for(;t=e.takeChar(e=>'"'!==e&&e!==M);)n+="\\"===t?this.getEscapeSequence(e):t;if(e.currentChar()===M)throw new q("E0020");return e.expectChar('"'),new x(n)}getLiteral(e){if(e.isNumberStart())return this.getNumber(e);if('"'===e.currentChar())return this.getString(e);throw new q("E0014")}}class F{constructor(e,t,n){this.type="Indent",this.value=e,this.span=new N(t,n)}}var J=function(e){return"get"+e.type},K={serialize:function(e){if(this[J(e)])return this[J(e)](e);console.warn("unknown type:",e.type,e)},getComment:function(e){return{key:"comment",value:e.content}},getGroupComment:function(){return null},getResourceComment:function(){return null},getMessage:function(e){var t=this;return{key:this[J(e.id)](e.id),value:this[J(e.value)](e.value),comment:e.comment&&this[J(e.comment)](e.comment),attributes:e.attributes&&e.attributes.map(function(e){return t.serialize(e)})}},getAttribute:function(e){return{key:this[J(e.id)](e.id),value:this[J(e.value)](e.value)}},getTerm:function(e){var t=this;return{key:"-".concat(this[J(e.id)](e.id)),value:this[J(e.value)](e.value),comment:e.comment&&this[J(e.comment)](e.comment),attributes:e.attributes&&e.attributes.map(function(e){return t.serialize(e)})}},getIdentifier:function(e){return e.name},getStringLiteral:function(e){return e.value},getPattern:function(e){var t=this;return e.elements.map(function(e){return e.expression?t[J(e.expression)]?t[J(e.expression)](e.expression):console.log("unknown1",J(e.expression),e.expression):t[J(e)]?t[J(e)](e):console.log("unknown2",J(e),e)}).join("")},getCallExpression:function(e){var t=this,n=e.callee.name,r=e.positional.map(function(e){return t[J(e)](e,!0)}),s=e.named.map(function(e){return t[J(e)](e)});return"{ "+n+"($"+r.join(" ")+(s.length?", "+s.join(", "):"")+") }"},getNamedArgument:function(e){return this[J(e.name)](e.name)+': "'+this[J(e.value)](e.value)+'"'},getTextElement:function(e){return e.value},getSelectExpression:function(e){var t=this;return"{ $"+this[J(e.selector)](e.selector,!0)+" ->\n"+e.variants.map(function(e){return t[J(e)](e)}).join("\n")+"\n}"},getVariantExpression:function(e){var t=this[J(e.ref)](e.ref,!0),n=this[J(e.key)](e.key);return n?"{ "+t+"["+n+"] }":" { "+t+" } "},getVariableReference:function(e,t){return t?this[J(e.id)](e.id):"{ $"+this[J(e.id)](e.id)+" }"},getTermReferences:function(e,t){return t?this[J(e.id)](e.id):"{ "+this[J(e.id)](e.id)+" }"},getVariantName:function(e){return e.name},getVariantList:function(e){var t=this;return"{\n"+e.variants.map(function(e){return t[J(e)](e)}).join("\n")+"\n}"},getVariant:function(e){var t=e.key.name?e.key.name:e.key.value,n=e.default,r="["+t+"] "+this[J(e.value)](e.value);return n?" *"+r:"  "+r},getFunctionReference:function(e){var t="";return e.arguments.positional.forEach(function(e,n){n>0&&(t+=", "),t+="$".concat(e.id.name)}),e.arguments.named.forEach(function(e,n){(n>0||""!==t)&&(t+=", "),t+="".concat(e.name.name,': "').concat(e.value.value,'"')}),"{ ".concat(e.id.name,"(").concat(t,") }")},getTermReference:function(e){return"{ -".concat(e.id.name," }")},getJunk:function(e){var t=e.content.split("=");return{key:t.shift().trim(),value:t.join("=").trim().replace(/\n {3}/g,"\n ").replace(/\n {2}}/g,"\n}")}}};function Z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{respectComments:!0};if("string"!=typeof e){if(!t)throw new Error("The first parameter was not a string");return t(new Error("The first parameter was not a string"))}var r,s=(r=e,new X({withSpans:!1}).parse(r)).body.reduce(function(e,t){var r=K.serialize(t);if(!r)return e;if(r.attributes&&r.attributes.length||r.comment&&n.respectComments){var s={};r.comment&&(s[r.comment.key]=r.comment.value),r.attributes&&r.attributes.length&&r.attributes.forEach(function(e){s[e.key]=e.value}),s.val=r.value,e[r.key]=s}else e[r.key]=r.value;return e},{});return t&&t(null,s),s}class _{constructor(e,t={}){this.init(e,t),this.type="backend"}init(e,r={}){this.services=e,this.options=function(e){return t.call(n.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e}(r,this.options||{},{loadPath:"/locales/{{lng}}/{{ns}}.ftl",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(e,t){return Z(e)},crossDomain:!1,ajax:s})}read(e,t,n){var r=this.options.loadPath;"function"==typeof this.options.loadPath&&(r=this.options.loadPath([e],[t]));let s=this.services.interpolator.interpolate(r,{lng:e,ns:t});this.loadUrl(s,n)}loadUrl(e,t){this.options.ajax(e,this.options,(n,r)=>{if(r.status>=500&&r.status<600)return t("failed loading "+e,!0);if(r.status>=400&&r.status<500)return t("failed loading "+e,!1);let s,i;try{s=this.options.parse(n,e)}catch(t){i="failed parsing "+e+" to json"}if(i)return t(i,!1);t(null,s)})}create(e,t,n,r){"string"==typeof e&&(e=[e]);let s={};s[n]=r||"",e.forEach(e=>{let n=this.services.interpolator.interpolate(this.options.addPath,{lng:e,ns:t});this.options.ajax(n,this.options,function(e,t){},s)})}}return _.type="backend",_});
